<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Bi-Static Stripes (Blend + Training-motion defined)</title>
  <style>
    body { margin:0; background:#000; color:#fff; font-family:sans-serif; }
    .controls {
      position:absolute; top:100px; right:500px;
      background:rgba(0,0,0,0.6); padding:10px; border-radius:5px; width:220px;
    }
    .controls label {
      display:flex; justify-content:space-between;
      align-items:center; margin:6px 0; font-size:14px;
    }
    .controls input[type=range] { width:110px; }
    .controls span.value { width:35px; text-align:right; font-family:monospace; }
    .controls output { width:40px; text-align:right; font-family:monospace; }
    .controls input[type=radio] { margin-right:6px; }
    .hide-control { display: none !important; }
  </style>
</head>
<body>
  <div class="controls">
    <button onclick="saveVals()">Train</button>
    <label><input name="motion" id="slideType" value="slide" type="radio" checked/> Sliding Dots</label>
    <label><input name="motion" id="regenType" value="regen" type="radio"/> Regenerating Dots</label>

    <label>Induction Time:
      <input id="indTime" type="range" min="1" max="20" step="1" value="10"
      oninput="this.nextElementSibling.value = this.value">
      <output>10</output>
    </label>
    
    <label>Number Bars:
      <input id="numBars" type="range" min="1" max="32" step="1" value="16"
      oninput="this.nextElementSibling.value = this.value">
      <output>16</output>
    </label>
    
    <label id="regenRateLabel" class="hide-control">Regen Rate:
      <input id="regenRate" type="range" min="0.01" max="2.0" step="0.01" value="1.0"
      oninput="this.nextElementSibling.value = this.value">
      <output>1.0</output>
    </label>
    
    <label id="slideSpeedLabel">Slide Speed:
      <input id="slideSpeed" type="range" min="0.1" max="10.0" step="0.1" value="6.0"
      oninput="this.nextElementSibling.value = this.value">
      <output>6.0</output>
    </label>
    
    <label>Pixel Size:
      <input id="pixelSize" type="range" min="0.5" max="10.0" step="0.5" value="1.0"
      oninput="this.nextElementSibling.value = this.value">
      <output>1.0</output>
    </label>
  </div>

  <script>
    const slideRadio = document.getElementById('slideType');
    const regenRadio = document.getElementById('regenType');

    // Toggles between slideSpeed and regenRate controls
    function hideRegen(){
        slideSpeedLabel.classList.remove('hide-control');
        regenRateLabel.classList.add('hide-control');
    }
    function hideSlide(){
        slideSpeedLabel.classList.add('hide-control');
        regenRateLabel.classList.remove('hide-control');
    }
      
    // Set up event listener for radio buttons
    slideRadio.addEventListener('change', hideRegen);
    regenRadio.addEventListener('change', hideSlide);
    
    function saveVals() {
      // Get all current values
      motionTypeVal = 'regen';
      speedVal = document.getElementById('regenRate').value;

      if(slideRadio.checked){
        motionTypeVal = 'slide';
        speedVal = document.getElementById('slideSpeed').value;
      }

      const config = {
        motionType: motionTypeVal,
        indTime: document.getElementById('indTime').value,
        numBars: document.getElementById('numBars').value,
        speed: speedVal,
        pixelSize: document.getElementById('pixelSize').value,
      };
      
      // Save to sessionStorage
      sessionStorage.setItem('stimulusConfig', JSON.stringify(config));
      
      // For debugging: log the saved values
      console.log('Saved configuration:', config);
      
      // Navigate to training page
      window.location.href = 'train.html';
    }
  </script>

</body>
</html>